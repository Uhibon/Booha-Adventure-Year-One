<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Booha Maze — Fullscreen Adventure</title>
<style>
:root { --zoom:1; --tx:0px; --ty:0px; }
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#0b1530}
.viewport{position:relative;width:100%;height:100%;overflow:hidden;touch-action:none;}
.world{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(var(--zoom));transform-origin:center;transition:transform .55s ease;}
#maze{width:100vw;height:100vh;background:url('assets/maze.png') center/contain no-repeat;}
#booha{position:absolute;width:64px;height:64px;transform:translate(-50%,-50%);z-index:10;pointer-events:none;filter:drop-shadow(0 0 12px #ffd400a6);} 
.stop{position:absolute;width:18px;height:18px;border-radius:50%;transform:translate(-50%,-50%);cursor:pointer;opacity:.9;background:radial-gradient(circle,#29365d 0%, #1c2847 65%, #17223e 100%);box-shadow:0 0 0 2px #0008 inset;}
.stop.active{background:radial-gradient(circle,#c7fbff 0%, #65e7ff 60%, #2bd0ff 100%);box-shadow:0 0 0 2px #00141e inset, 0 0 14px #65e7ffbb, 0 0 30px #2bd0ff55;}
.spark{position:absolute;width:6px;height:6px;border-radius:50%;pointer-events:none;background:radial-gradient(circle at 35% 35%, #fff, #ffe66d 60%, transparent 72%);box-shadow:0 0 10px currentColor;animation:spark .7s ease-out forwards;}
@keyframes spark{0%{transform:scale(.85);opacity:1}60%{transform:scale(1.1)}100%{transform:scale(.2) translateY(6px);opacity:0}}
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:100;background:#0008;}
.modal.show{display:flex;}
.modal .card{background:#101d42;padding:20px;border-radius:16px;text-align:center;color:#fff;}
</style>
</head>
<body>
<div class="viewport" id="viewport">
  <div class="world" id="world">
    <div id="maze"></div>
  </div>
</div>
<img id="booha" src="assets/mazebooha.png" alt="booha" />
<div class="modal" id="modal"><div class="card"><h2 id="title">Month — Week</h2><a href="#" id="deck1">Deck 1</a> | <a href="#" id="deck2">Deck 2</a></div></div>
<script>
const MONTHS=['January','February','March','April','May','June','July','August','September','October','November','December'];
const TOTAL_STOPS=48;
const MONTH_COLORS=['#cddfff','#ffb6c1','#ffda8a','#a7f5b1','#7fdfff','#ffe066','#ff9edb','#f8b54c','#d6b3ff','#ff9851','#ffd6a1','#fff4c7'];
const maze=document.getElementById('maze');
const booha=document.getElementById('booha');
const modal=document.getElementById('modal');
const titleEl=document.getElementById('title');
const deck1=document.getElementById('deck1');
const deck2=document.getElementById('deck2');
const viewport=document.getElementById('viewport');
let currentIndex=0;

// Rough brown-path positions (adjusted for maze)
const POS=[
{x:5,y:8},{x:10,y:10},{x:15,y:14},{x:20,y:16},{x:24,y:20},{x:28,y:24},{x:32,y:28},{x:36,y:32},{x:40,y:35},{x:44,y:40},{x:48,y:44},{x:52,y:48},
{x:56,y:52},{x:60,y:56},{x:64,y:60},{x:68,y:63},{x:72,y:66},{x:76,y:70},{x:80,y:74},{x:83,y:78},{x:86,y:82},{x:88,y:86},{x:91,y:90},{x:93,y:94},
{x:6,y:20},{x:8,y:25},{x:12,y:30},{x:15,y:35},{x:18,y:40},{x:22,y:45},{x:26,y:50},{x:30,y:55},{x:34,y:60},{x:38,y:65},{x:42,y:70},{x:46,y:75},
{x:50,y:80},{x:54,y:85},{x:58,y:88},{x:62,y:90},{x:66,y:92},{x:70,y:94},{x:74,y:95},{x:78,y:96},{x:82,y:97},{x:86,y:98},{x:90,y:99},{x:94,y:99}
];

const stops=[];const world=document.getElementById('world');
POS.forEach((p,i)=>{const el=document.createElement('div');el.className='stop';el.style.left=p.x+'%';el.style.top=p.y+'%';world.appendChild(el);stops.push({i,x:p.x,y:p.y,el});});

function spawnSpark(x,y,c){const s=document.createElement('i');s.className='spark';s.style.color=c||'#ffd400';s.style.left=x+'px';s.style.top=y+'px';document.body.appendChild(s);setTimeout(()=>s.remove(),720);}
function moveBooha(to){return new Promise(resolve=>{const from=stops[currentIndex];const end=stops[to];const mazeRect=maze.getBoundingClientRect();const sx=mazeRect.left+(from.x/100)*mazeRect.width;const sy=mazeRect.top+(from.y/100)*mazeRect.height;const ex=mazeRect.left+(end.x/100)*mazeRect.width;const ey=mazeRect.top+(end.y/100)*mazeRect.height;const t0=performance.now();const dur=1500;function step(t){const k=Math.min(1,(t-t0)/dur);const e=k<.5?2*k*k:1-Math.pow(-2*k+2,2)/2;const x=sx+(ex-sx)*e;const y=sy+(ey-sy)*e;booha.style.left=x+'px';booha.style.top=y+'px';if(Math.random()<.8)spawnSpark(x,y,MONTH_COLORS[Math.floor(to/4)]);if(k<1)requestAnimationFrame(step);else resolve();}requestAnimationFrame(step);});}
function zoomTo(i){const n=stops[i];const zoom=1.3;const rect=maze.getBoundingClientRect();const cx=(n.x/100)*rect.width-rect.width/2;const cy=(n.y/100)*rect.height-rect.height/2;document.documentElement.style.setProperty('--zoom',zoom);document.documentElement.style.setProperty('--tx',(-cx*(zoom-1)/zoom)+'px');document.documentElement.style.setProperty('--ty',(-cy*(zoom-1)/zoom)+'px');}
function zoomReset(){document.documentElement.style.setProperty('--zoom',1);document.documentElement.style.setProperty('--tx','0px');document.documentElement.style.setProperty('--ty','0px');}
function burstAt(i){const n=stops[i];const mazeRect=maze.getBoundingClientRect();const bx=mazeRect.left+(n.x/100)*mazeRect.width;const by=mazeRect.top+(n.y/100)*mazeRect.height;for(let k=0;k<12;k++)setTimeout(()=>spawnSpark(bx+(Math.random()*40-20),by+(Math.random()*40-20),MONTH_COLORS[Math.floor(i/4)]),k*28);}
function openWeek(i){const m=Math.floor(i/4),w=(i%4)+1;titleEl.textContent=`${MONTHS[m]} — Week ${w}`;deck1.href=`placeholder.html?month=${MONTHS[m]}&week=${w}&deck=1`;deck2.href=`placeholder.html?month=${MONTHS[m]}&week=${w}&deck=2`;modal.classList.add('show');}
modal.addEventListener('click',()=>{modal.classList.remove('show');zoomReset();});
async function goTo(i){await moveBooha(i);currentIndex=i;stops[i].el.classList.add('active');burstAt(i);zoomTo(i);setTimeout(()=>openWeek(i),500);}
stops.forEach((n,i)=>{n.el.addEventListener('click',()=>goTo(i));});
window.addEventListener('resize',()=>{booha.style.left=stops[currentIndex].x+'%';booha.style.top=stops[currentIndex].y+'%';});
</script>
</body>
</html>
